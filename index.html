<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Task Manager</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            background: black;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            height: 100vh;
            width: 100vw;
        }

        .container {
            width: 100%;
            height: calc(100% - 50px); /* Reserve space for the edit button */
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            align-items: center;
            padding: 10px;
        }

        .tasks {
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            width: 100%;
            height: 100%;
        }

        .task {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 20%; /* Fixed height */
            background: #000000;
            color: #00ff00;
            text-align: center;
            border: 1px solid #00ff00;
            overflow: hidden; /* Prevent overflow */
            white-space: normal; /* Allow wrapping */
            word-wrap: break-word; /* Ensure words break when necessary */
        }

        .task.completed {
            color: #666;
        }

        .edit-dot {
            position: fixed;
            top: 20px;
            left: 20px;
            cursor: pointer;
            color: #00ff00;
            z-index: 100;
        }

        .edit-dot svg {
            width: 30px;
            height: 30px;
        }

        .task-edit-popup {
            display: none;
            position: fixed; /* Change from absolute to fixed */
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            z-index: 200;
        }

        .task-edit-popup input {
            text-align: center;
            font-size: 5vh;
            border: 2px solid #00ff00;
            background: black;
            color: #00ff00;
            width: 100%;
            height: 15%;
        }

        .task-edit-popup button {
            font-family: 'Courier New', monospace;
            font-size: 5vh;
            background: #00ff00;
            color: black;
            border: none;
            cursor: pointer;
            width: 100%;
            height: 15%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tasks">
            <div id="task1" class="task" onclick="toggleTaskCompletion('task1')">
                Hack the mainframe
            </div>
            <div id="task2" class="task" onclick="toggleTaskCompletion('task2')">
                Intercept data stream
            </div>
            <div id="task3" class="task" onclick="toggleTaskCompletion('task3')">
                Decrypt payload
            </div>
            <div id="task4" class="task" onclick="toggleTaskCompletion('task4')">
                Analyze threat vectors
            </div>
            <div id="task5" class="task" onclick="toggleTaskCompletion('task5')">
                Prepare for zero day
            </div>
        </div>
    </div>

    <div class="edit-dot" onclick="showTaskEditPopup()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 20h9"></path>
            <path d="M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
        </svg>
    </div>

    <div class="task-edit-popup" id="taskEditPopup">
        <input type="text" id="editTask1" placeholder="Task 1">
        <input type="text" id="editTask2" placeholder="Task 2">
        <input type="text" id="editTask3" placeholder="Task 3">
        <input type="text" id="editTask4" placeholder="Task 4">
        <input type="text" id="editTask5" placeholder="Task 5">
        <button onclick="saveTasks()">Save</button>
    </div>

    <script>
function loadTasks() {
    const tasks = ["Hack the mainframe", "Intercept data stream", "Decrypt payload", "Analyze threat vectors", "Prepare for zero day"];
    for (let i = 0; i < tasks.length; i++) {
        const taskElement = document.getElementById(`task${i + 1}`);
        if (taskElement) {
            const taskStatus = localStorage.getItem(`task${i + 1}`);
            if (taskStatus === 'completed') {
                taskElement.classList.add('completed');
            }
            taskElement.textContent = localStorage.getItem(`taskText${i + 1}`) || tasks[i];
        }
    }
    updateTasks();
}

function toggleTaskCompletion(taskId) {
    const taskElement = document.getElementById(taskId);
    taskElement.classList.toggle('completed');
    const taskIndex = taskId.replace('task', '') - 1;
    localStorage.setItem(`task${taskIndex + 1}`, taskElement.classList.contains('completed') ? 'completed' : 'pending');
    localStorage.setItem(`taskText${taskIndex + 1}`, taskElement.textContent);
    updatePunishmentState();
}

function showTaskEditPopup() {
    for (let i = 1; i <= 5; i++) {
        document.getElementById(`editTask${i}`).value = document.getElementById(`task${i}`).textContent;
    }
    document.getElementById('taskEditPopup').style.display = 'block';
}

function saveTasks() {
    editableTask = editableTasks();
    // Disable or enable edit for tasks based on the day
    for (let i = 1; i <= 5; i++) {
        const taskElement = document.getElementById(`task${i}`);
        if (i === editableTask) {
            const taskValue = document.getElementById(`editTask${i}`).value;
            document.getElementById(`task${i}`).textContent = taskValue;
            localStorage.setItem(`taskText${i}`, taskValue);
        }
    }
    document.getElementById('taskEditPopup').style.display = 'none';
    updatePunishmentState();
    adjustFontSize(); // Adjust font size after saving
}

function updateTasks() {
    editableTask = editableTasks();
    // Disable or enable edit for tasks based on the day
    for (let i = 1; i <= 5; i++) {
        const taskElement = document.getElementById(`task${i}`);
        if (i === editableTask) {
            taskElement.style.pointerEvents = 'auto'; // Disable editing
        } else {
            taskElement.style.pointerEvents = 'none'; // Disable editing
        }
    }
    updatePunishmentState();
    adjustFontSize(); // Adjust font size after saving
}

function editableTasks() {
    const dayOfWeek = new Date().getDay();
    const currentTime = new Date().getHours();
    let editableTask = null;

    // Determine editable task based on the day and time
    if (dayOfWeek === 1) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 1;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 2) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 2;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 3) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 2;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 4) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 3;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 5) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 3;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 6) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 4;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    } else if (dayOfWeek === 0) {
       if (currentTime >= 5 && currentTime <= 14 || currentTime >= 16 && currentTime <= 20) {
        editableTask = 4;
       } else if (currentTime >= 14 && currentTime <= 16 || currentTime >= 20 && currentTime <= 23) {
        editableTask = 5;
       }
    }
    return editableTask;
}

function adjustFontSize() {
    const tasks = document.querySelectorAll('.task');
    tasks.forEach(task => {
        let fontSize = 1; // Start with 1px
        task.style.fontSize = `${fontSize}px`;
        task.style.lineHeight = 'normal'; // Allow line breaks

        // Measure if text fits the box
        while (
            task.scrollWidth <= task.clientWidth &&
            task.scrollHeight <= task.clientHeight
        ) {
            fontSize++;
            task.style.fontSize = `${fontSize}px`;
        }

        // Reduce the font size slightly to ensure it fits
        task.style.fontSize = `${fontSize - 1}px`;
    });
}

function updatePunishmentState() {
    const dayOfWeek = new Date().getDay();
    const currentTime = new Date().getHours();
    const editDot = document.querySelector('.edit-dot');
    for (let i = 1; i <= 5; i++) {
        const taskElement = document.getElementById(`task${i}`);
        const taskStatus = localStorage.getItem(`task${i}`);
        const taskPunishment = localStorage.getItem(`task${i}-punishment`);
        if (taskElement.style.pointerEvents === 'none') {
            if (taskStatus !== 'completed') {
		    if (dayOfWeek !== 1 && i === 1) {
		          taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                          localStorage.setItem(`task${i}-punishment`, 'punishment');
                          localStorage.setItem(`taskText${i}`, 'punishment task');
		    } else if (dayOfWeek !== 3 && dayOfWeek !== 2 && i === 2) {
		           taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                           localStorage.setItem(`task${i}-punishment`, 'punishment'); 
                           localStorage.setItem(`taskText${i}`, 'punishment task');
		    } else if (dayOfWeek !== 5 && dayOfWeek !== 4 && i === 3) {
		           taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                           localStorage.setItem(`task${i}-punishment`, 'punishment');
                           localStorage.setItem(`taskText${i}`, 'punishment task');
		    } else if (dayOfWeek !== 0 && dayOfWeek !== 6 && i === 4) {
		           taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                           localStorage.setItem(`task${i}-punishment`, 'punishment');   
                           localStorage.setItem(`taskText${i}`, 'punishment task');
		    } else if (dayOfWeek === 0 && currentTime >= 23 && i === 5) {
		           taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                           localStorage.setItem(`task${i}-punishment`, 'punishment');   
                           localStorage.setItem(`taskText${i}`, 'punishment task');
		    } else if (dayOfWeek === 1 && currentTime < 14 && i === 5) {
		           taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                           localStorage.setItem(`task${i}-punishment`, 'punishment');   
                           localStorage.setItem(`taskText${i}`, 'punishment task');
		    }
            }
        } else {
            if (taskPunishment === 'punishment') {
                 taskElement.textContent = 'punishment task'; // Set the task to "task locked" if locked
                 localStorage.setItem(`task${i}-punishment`, 'punishment');   
                 localStorage.setItem(`taskText${i}`, 'punishment task');
                 taskElement.style.border = "1px solid #ff0000";
                 editDot.style.color = "#ff0000";
                 if (taskElement.classList.contains('completed')) {
                      taskElement.style.color = "#333";
                 } else {
                      taskElement.style.color = "#ff0000";
                 }
                 for (let j = 1; j <= 5; j++) {
                    if (j !== i) {
                         const taskElementback = document.getElementById(`task${j}`);
                         taskElementback.style.border = "2px solid #ff0000";
                         taskElementback.style.filter = "blur(10px)";
                         if (taskElementback.classList.contains('completed')) {
		              taskElementback.style.color = "#333";
		         } else {
		              taskElementback.style.color = "#ff0000";
		         }
                    }
                 }
            } else {
                 taskElement.style.border = "1px solid #00ff00";
                 editDot.style.color = "#00ff00";
                 if (taskElement.classList.contains('completed')) {
                      taskElement.style.color = "#333";
                 } else {
                      taskElement.style.color = "#00ff00";
                 }
                 for (let j = 1; j <= 5; j++) {
                    if (j !== i) {
                         const taskElementback = document.getElementById(`task${j}`);
                         taskElementback.style.border = "2px solid #00ff00";
                         if (taskElementback.classList.contains('completed')) {
		              taskElementback.style.color = "#333";
		         } else {
		              taskElementback.style.color = "#00ff00";
		         }
                         taskElementback.style.filter = "blur(10px)";
                    }
                 }       
            }
        }
    }
}


// Load the tasks and adjust font size on page load
window.onload = loadTasks;

    </script>
</body>
</html>
